{% if post.author %}
{% assign author = site.authors | where: 'username', post.author | first %}
{% else %}
{% assign author = site.authors | where: 'default', true | first %}
{% endif %}

{% if include.text_only %}
<article class="uk-card uk-grid-collapse uk-margin-large" data-uk-grid>
  <div class="uk-width-1-1">
    <div class="uk-card-body">
      {% if post.id and post.categories %}
      <div class="uk-text-uppercase article-title-font card-categories">
        {% for category in post.categories %}
        <a class="link-primary" href="/category/{{ category }}">{{category}}</a>
        {% unless forloop.last %}{% endunless %}
        {% endfor %}
      </div>
      {% endif %}
      <h3 class="uk-card-title article-title-font"><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h3>
      <div class="content-secondary">{{ post.excerpt }}</div>
      <div class="card-meta">
        <b>{{ site.strings.author_by | default: 'By' }} <a href="{{ author.url }}" rel="author"
            title="{{ author.title }}">{{ author.title }}</a></b>
        <time class="uk-margin-small-left" datetime="{{ post.date | date_to_xmlschema }}">
          {% assign date_format = site.date_format | default: "%b %-d, %Y" %}
          {{ post.date | date: date_format }}
        </time>
      </div>
    </div>
  </div>
</article>
{% else %}
<article class="uk-card uk-grid-collapse uk-margin-large" data-uk-grid>
  <div class="uk-width-1-3@s uk-card-media-left media-1-3 uk-cover-container">
    {% if post.image %}
    <a href="{{ post.url | relative_url }}">
      {% assign original_url = post.image %}
      {% unless post.image contains 'http' %}
      {% assign original_url = site.uploads | absolute_url | append: post.image %}
      {% endunless %}
      {% if jekyll.environment == 'production' %}
        {% assign base_cdn = site.url | append: '/.netlify/images?url=' %}
        {% assign fit_params = '&fit=cover&fm=webp' %}
        {% assign encoded = original_url | url_encode %}
        {% assign w400 = base_cdn | append: encoded | append: '&w=400&h=300' | append: fit_params %}
        {% assign w600 = base_cdn | append: encoded | append: '&w=600&h=450' | append: fit_params %}
        {% assign w800 = base_cdn | append: encoded | append: '&w=800&h=600' | append: fit_params %}
        <img
          src="{{ w600 }}"
          srcset="{{ w400 }} 400w, {{ w600 }} 600w, {{ w800 }} 800w"
          sizes="(min-width: 960px) 33vw, 100vw"
          alt="{{ post.title }}" data-uk-cover loading="lazy" decoding="async">
      {% else %}
        <img src="{{ original_url }}" alt="{{ post.title }}" data-uk-cover loading="lazy" decoding="async">
      {% endif %}
      <canvas width="600" height="450"></canvas>
    </a>
    {% endif %}
  </div>
  <div class="uk-width-expand@s">
    <div class="uk-card-body">
      {% if post.id and post.categories %}
      <div class="uk-text-uppercase article-title-font card-categories">
        {% for category in post.categories %}
        <a class="link-primary" href="/category/{{ category }}">{{category}}</a>
        {% unless forloop.last %}{% endunless %}
        {% endfor %}
      </div>
      {% endif %}
      <h3 class="uk-card-title article-title-font"><a href="{{ post.url | relative_url }}">{{ post.title }}</a></h3>
      <div class="content-secondary">{{ post.excerpt }}</div>
      <div class="card-meta">
        <b>{{ site.strings.author_by | default: 'By' }} <a href="{{ author.url }}" rel="author"
            title="{{ author.title }}">{{ author.title }}</a></b>
        <time class="uk-margin-small-left" datetime="{{ post.date | date_to_xmlschema }}">
          {% assign date_format = site.date_format | default: "%b %-d, %Y" %}
          {{ post.date | date: date_format }}
        </time>
      </div>
    </div>
  </div>
</article>
{% endif %}